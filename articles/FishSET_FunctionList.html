<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="FishSET">
<title>FishSET R package functions • FishSET</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="FishSET R package functions">
<meta property="og:description" content="FishSET">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">FishSET</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/FishSET_User_Manual.html">FishSET User Manual</a>
    <a class="dropdown-item" href="../articles/FishSET_FunctionList.html">FishSET R package functions</a>
    <a class="dropdown-item" href="../articles/FishSET_GUI_Quickstart_Guide.html">FishSET GUI Quickstart Guide</a>
    <a class="dropdown-item" href="../articles/scallop-example.html">Scallop Example</a>
    <a class="dropdown-item" href="../articles/scallop-mod-example.html">Scallop Conditional Logit Model Example</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/noaa-nwfsc/FishSET/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>FishSET R package functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/noaa-nwfsc/FishSET/blob/HEAD/vignettes/FishSET_FunctionList.Rmd" class="external-link"><code>vignettes/FishSET_FunctionList.Rmd</code></a></small>
      <div class="d-none name"><code>FishSET_FunctionList.Rmd</code></div>
    </div>

    
    
<!--  pdf_document: default -->
<!--  html_notebook: default-->
<!--  word_document: default-->
<!--  html_document:-->
<!--    df_print: paged-->
<p>##Getting started The FishSET R package includes functions that can
be used in the R console or that can be run through the FishSET app (a
guided user interface built u sing the Shiny R package). Calling
function through the R console allows for greater flexibility and ease
in troubleshooting but requires knowledge of R and the FishSET R
package. The FishSET app is meant to allow for users to use functions
and models with limited knowledge of R. The FishSET app is opened by
typing <code>run_fishset()</code> in the R console. This tutorial does
not use the FishSET app but walks through examples of FishSET R package
functions in the R console.</p>
<p>##Load the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'devtools'</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"PATH/TO/Directory/Containing/FishSET"</span>, repos<span class="op">=</span><span class="cn">NULL</span>, type<span class="op">=</span><span class="st">'source'</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FishSET</span><span class="op">)</span></span></code></pre></div>
<p>##Upload data When the data is loaded into the FishSET database a
series of checks are performed. The output of these checks will be
printed to the R console. Check these messages to identify if any
corrections should be made. In the box below, we load both the main data
set and the port data. We will also need a spatial data set. We will
load that with the <code>read_dat</code> function. The
<code>read_dat</code> function recognizes most data formats, including
spss, json, and stata, and reads the data into the working environment.
The functions does not save the data into the FishSET database.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Upload data</span></span>
<span><span class="fu"><a href="../reference/load_maindata.html">load_maindata</a></span><span class="op">(</span><span class="va">dat</span>, over_write <span class="op">=</span> <span class="cn">TRUE</span>, project <span class="op">=</span> <span class="st">'EXAMP'</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/load_port.html">load_port</a></span><span class="op">(</span><span class="va">dat</span>, port_name <span class="op">=</span> <span class="va">port</span>, over_write <span class="op">=</span> <span class="cn">TRUE</span>, project <span class="op">=</span> <span class="st">'EXAMP'</span><span class="op">)</span></span>
<span><span class="va">spatdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dat.html">read_dat</a></span><span class="op">(</span><span class="st">''</span><span class="op">)</span></span></code></pre></div>
<p>Data are now loaded into the FishSET database. The first line of code
below returns a list of all the data tables in the FishSET database. The
second line of code returns the first six lines of data from the data
table you just loaded into the database.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tables_database.html">tables_database</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/table_view.html">table_view</a></span><span class="op">(</span><span class="st">'projectMainDataTable'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Additional codes for working within the FishSET database:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#Check whether a table exists in the database.</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="fu">table_exists</span>()      </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#Remove a table from the database.</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a> <span class="fu">table_remove</span>()     </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">table_fields</span>()      View column names of data table.</span></code></pre></div>
<p>##Data Quality FishSET has built-in functions to check for NAs, NaNs,
outliers, unique observations, empty variables, and whether latitude and
longitude variables are in the correct format. The
<code>data_verification</code> function checks for these potential
issues. All messages returned to R console are also saved in the log
file.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="../reference/data_verification.html">data_verification</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co"># The following functions are contained in `data_verification` but can be run on their own too.</span></span>
<span>    <span class="fu">outlier_check</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/nan_identify.html">nan_identify</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Functions also exist to view table or plot output of data quality
assessments. All plots and tables are automatically saved with project
name to the <code>output</code> folder in the FishSET R package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Table output functions</span></span>
<span>  <span class="fu"><a href="../reference/summary_stats.html">summary_stats</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/outlier_table.html">outlier_table</a></span><span class="op">(</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="co">#Plots output functions</span></span>
<span>  <span class="fu"><a href="../reference/outlier_plot.html">outlier_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Functions to correct data quality issues.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="../reference/na_filter.html">na_filter</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/nan_filter.html">nan_filter</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="../reference/outlier_remove.html">outlier_remove</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="../reference/unique_filter.html">unique_filter</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="../reference/empty_vars_filter.html">empty_vars_filter</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="../reference/degree.html">degree</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Data tables can be filtered using the <code>filter_table</code> and
<code>filter_dat</code> functions. The filter statements are saved as a
table in the FishSET database and can be applied to any dataset using
the <code>filter_dat</code> function. No function has been written to
remove variables from the working data set. Users should use base R
functions for this. Within the FishSET app variables can be removed from
the working data set in the <code>Data Exploration</code> tab. Use the
<code>add_vars</code> function to add variables from the raw data set
back into the working data set.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Filter</span></span>
<span>  <span class="fu"><a href="../reference/filter_table.html">filter_table</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/filter_dat.html">filter_dat</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Add variables back into the working data set</span></span>
<span>  <span class="fu"><a href="../reference/add_vars.html">add_vars</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>##Data Exploration<br>
View the spatial (<code>map_plot</code>) and temporal
(<code>temp_plot</code>) distribution of data and the relationship
between variables (<code>xy_plot</code>). Plots and tables to the
<code>output</code> folder. The <code>map_kernel</code>,
<code>getis_ord_stats</code>, and <code>moran_stats</code> functions
provide measures of clustering, or hot spot analysis. The
<code>density_plot</code> creates a density or cumulative distribution
function plot of the selected variable.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Map</span></span>
<span>  <span class="fu"><a href="../reference/map_plot.html">map_plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#map kernel</span></span>
<span>  <span class="fu"><a href="../reference/map_kernel.html">map_kernel</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#Getis Ord</span></span>
<span>  <span class="fu"><a href="../reference/getis_ord_stats.html">getis_ord_stats</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#Moran's I</span></span>
<span>  <span class="fu"><a href="../reference/moran_stats.html">moran_stats</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#Temporal Plots</span></span>
<span>  <span class="fu"><a href="../reference/temp_plot.html">temp_plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#x-y plots</span></span>
<span>  <span class="fu"><a href="../reference/xy_plot.html">xy_plot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">project</span>, <span class="va">var1</span>, <span class="va">var2</span>, regress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span>  <span class="fu"><a href="../reference/density_plot.html">density_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>##Fleet Analyses Fleet functions focus on functions that allow users
to assign vessels to fleet and view fleet characteristics (vessel count)
and fleet effort (trip length, weekly effort), and catch as a fleet
(species catch, by catch, weekly catch). All functions return output as
plots and/or tables that are output to the R console and saved to the
<code>output</code> folder.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Define and store fleet expressions </span></span>
<span>  <span class="fu"><a href="../reference/fleet_assign.html">fleet_assign</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">project</span>, cond <span class="op">=</span> <span class="cn">NULL</span>, fleet_val <span class="op">=</span> <span class="cn">NULL</span>, table <span class="op">=</span> <span class="cn">NULL</span>, save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#Number of unique vessels by time period</span></span>
<span>  <span class="fu"><a href="../reference/vessel_count.html">vessel_count</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">project</span>, <span class="va">v</span>, <span class="va">t</span>, period <span class="op">=</span> <span class="st">"month"</span>, group <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                         year <span class="op">=</span> <span class="cn">NULL</span>, position <span class="op">=</span> <span class="st">"stack"</span>, output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"table"</span>, <span class="st">"plot"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Total species catch by period</span></span>
<span>  <span class="fu"><a href="../reference/species_catch.html">species_catch</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">project</span>, <span class="va">species</span>, <span class="va">date</span>, period <span class="op">=</span> <span class="st">"month_abv"</span>, fun <span class="op">=</span> <span class="st">"sum"</span>, group <span class="op">=</span> <span class="cn">NULL</span>, year <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                          convert_to_tons <span class="op">=</span> <span class="cn">TRUE</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"count"</span>, <span class="st">"percent"</span><span class="op">)</span>, </span>
<span>                          output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"table"</span>, <span class="st">"plot"</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"stack"</span>, format_tab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wide"</span>, <span class="st">"long"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Compare bycatch to other species caught</span></span>
<span>  <span class="fu"><a href="../reference/bycatch.html">bycatch</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">project</span>, <span class="va">cpue</span>, catch <span class="op">=</span> <span class="cn">NULL</span> , <span class="va">date</span>, names <span class="op">=</span> <span class="cn">NULL</span>, group <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                    year <span class="op">=</span> <span class="cn">NULL</span>, period <span class="op">=</span> <span class="st">"year"</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"count"</span>, <span class="st">"stc"</span><span class="op">)</span>, </span>
<span>                    output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"table"</span>, <span class="st">"plot"</span><span class="op">)</span>, format_tab <span class="op">=</span> <span class="st">"wide"</span><span class="op">)</span></span>
<span><span class="co">#Aggregate species catch by unique vessel ID</span></span>
<span>  <span class="fu">sum_catch</span><span class="op">(</span><span class="st">"MainDataTable"</span>, <span class="st">"myProject"</span>, <span class="st">"catch"</span>, <span class="st">"species == 'cod' &amp; catch &gt; .5"</span>, val <span class="op">=</span> <span class="st">"per"</span>, out <span class="op">=</span> <span class="st">"logical"</span><span class="op">)</span></span>
<span><span class="co">#Catch total by week</span></span>
<span>  <span class="fu"><a href="../reference/weekly_catch.html">weekly_catch</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">project</span>, <span class="va">species</span>, <span class="va">date</span>, year <span class="op">=</span> <span class="cn">NULL</span>, group <span class="op">=</span> <span class="cn">NULL</span>, fun <span class="op">=</span> <span class="st">"sum"</span>, position <span class="op">=</span> <span class="st">"stack"</span>,</span>
<span>                         convert_to_tons <span class="op">=</span> <span class="cn">FALSE</span>, value <span class="op">=</span><span class="st">"percent"</span>, output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plot"</span>, <span class="st">"table"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Average CPUE by week</span></span>
<span>  <span class="fu"><a href="../reference/weekly_effort.html">weekly_effort</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">project</span>, <span class="va">cpue</span>, <span class="va">date</span>, group <span class="op">=</span> <span class="cn">NULL</span>, year <span class="op">=</span> <span class="cn">NULL</span>, plot_type <span class="op">=</span> <span class="st">"line_point"</span>, </span>
<span>                          output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plot"</span>, <span class="st">"table"</span><span class="op">)</span>, format_tab <span class="op">=</span> <span class="st">"wide"</span><span class="op">)</span></span>
<span><span class="co">#Create a plot or table of vessel trip length</span></span>
<span>  <span class="fu">trip_length</span><span class="op">(</span><span class="va">dat</span>, <span class="va">project</span>, <span class="va">start</span>, <span class="va">end</span>, units <span class="op">=</span> <span class="st">"days"</span>, catch <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                        hauls <span class="op">=</span> <span class="cn">NULL</span>, output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"table"</span>, <span class="st">"plot"</span><span class="op">)</span>, haul_to_trip <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>##Simple Analyses<br>
View and quantify relationship between variables. The correlation
function, <code>corr_out</code> returns a plot and table of correlations
values between all numberic variables supplied. The regression function,
<code>xy_plot', returns a plot with fitted simple linear regression line and test statitistics whne regress is set to TRUE. When</code>regress`
is set to FALSE, points are plotted without a best fit line.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#correlation</span></span>
<span>  <span class="fu"><a href="../reference/corr_out.html">corr_out</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">project</span>, variables<span class="op">=</span><span class="st">'all'</span><span class="op">)</span></span>
<span><span class="co">#regression</span></span>
<span>  <span class="fu"><a href="../reference/xy_plot.html">xy_plot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">project</span>, <span class="va">var1</span>, <span class="va">var2</span>, regress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>##Compute New Variables<br>
Modify or create variables such as cpue and trip centroid. Functions
focus on data transformations, generating ID variables (for haul or
fishery season), computing simple arithmetic functions such as catch per
unit effort or sum of hauls, generate dummy variablesm, create a variety
of spatial variables such as distance between hauls or the latitude and
longitude of the haul midpoint, and create trip level functions such
collapsing haul to trip and identfiying trip centroid.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Data Transformations</span></span>
<span>  <span class="co">##Change time unit</span></span>
<span>  <span class="va">temporal_mod</span></span>
<span>  <span class="co">##Coded variable based on quantiles</span></span>
<span>  <span class="fu"><a href="../reference/set_quants.html">set_quants</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#Nominal ID</span></span>
<span>  <span class="co">#Haul or Trip ID</span></span>
<span>  <span class="fu"><a href="../reference/ID_var.html">ID_var</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co">#Fishery Seasonal Identifier</span></span>
<span>  <span class="fu"><a href="../reference/create_seasonal_ID.html">create_seasonal_ID</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#Arithmetic and temporal</span></span>
<span>  <span class="co">#Numeric functions</span></span>
<span>  <span class="fu"><a href="../reference/create_var_num.html">create_var_num</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co">#CPUE</span></span>
<span>  <span class="fu"><a href="../reference/cpue.html">cpue</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#Dummy</span></span>
<span>  <span class="co">#From variable</span></span>
<span>  <span class="fu"><a href="../reference/dummy_num.html">dummy_num</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/dummy_matrix.html">dummy_matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#spatial</span></span>
<span>  <span class="co">#Distance between two points</span></span>
<span>  <span class="fu"><a href="../reference/create_dist_between.html">create_dist_between</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co">#Haul midpoint </span></span>
<span>  <span class="fu"><a href="../reference/create_mid_haul.html">create_mid_haul</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co">#Duration of time</span></span>
<span>  <span class="fu"><a href="../reference/create_duration.html">create_duration</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co">#Zone when choice where to go next was made</span></span>
<span>  <span class="fu"><a href="../reference/create_startingloc.html">create_startingloc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#Trip-level Functions</span></span>
<span>  <span class="co">#Collapse Haul to trip</span></span>
<span>  <span class="fu"><a href="../reference/haul_to_trip.html">haul_to_trip</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co">#Trip distance</span></span>
<span>  <span class="fu"><a href="../reference/create_trip_distance.html">create_trip_distance</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co">#Trip centroid</span></span>
<span>  <span class="fu"><a href="../reference/create_trip_centroid.html">create_trip_centroid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>##Zonal Definition<br>
Functions in this group require a spatial data frame defining fishing or
regulatory zone. Both the <code>find_centroid</code> and
<code>assignment_column</code> can be used on their own but are called
as necessary in other function. The <code>find_centroid</code> function
identifies the centroid of a zone and the <code>assignment_column</code>
function assigns observations in the primary data set to zones. The
<code>create_alternative_choice</code> function defines alternative
fishing choices and is required.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="../reference/find_centroid.html">find_centroid</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/assignment_column.html">assignment_column</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/create_alternative_choice.html">create_alternative_choice</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>##Expected Catch/Revenue<br>
Compute expected catch or expected revenue. The function creates the
expected catch/revenue matrix based on user-provided parameters, and
three default cases: Near-term: Movng window size of two days. In this
case, vessels are grouped based on defineGroup parameter. Medium-term:
Moving window size of seven days. In this case, there is no grouping and
catch for entire fleet is used. Long-term: Moving window size of seven
days from the previous year. In this case, there is no grouping and
catch for entire fleet is used. Output is saved in the FishSET database
and called in the <code>make_model_design</code> function.</p>
<p>The <code>sparstable</code> function provides a table of data
sparsity by time periods. It should be used to assess the availability
of data for defining the temporal moving window size in the
<code>create_expectations</code> function. Sparse data is not suited for
shorter moving window sizes.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="../reference/sparsetable.html">sparsetable</a></span><span class="op">(</span><span class="op">)</span>  </span>
<span>  <span class="fu"><a href="../reference/create_expectations.html">create_expectations</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>##Model design file and run The <code>make_model_design</code>
function creates a list with data and parameters required to run the
models, which are called in the <code>discretefish_subroutine</code>
function. The <code>discretefish_subroutine</code> requires inputs of
initial parameters, optimization options (maximum iterations, the
relative tolerance of x, report frequency, and whether to report
iterations), the optimization method chosen, which must be one of the
base R <code>optim</code> options, and a name for the model to allow for
easier tracking and comparison of models. The subroutine also requires
<code>catch</code>, <code>choice</code>, and <code>distance</code> data,
plus any other data <code>otherdat</code> needed to run the chosen
likelihood, such as expected catches or harvester data. These data are
defined in the <code>make_model_design</code> file. Expected catches is
pulled by the <code>make_model_design</code> function from the saved
table generated by the <code>create_expectations</code> function.
<code>make_model_design</code> calls output from
<code>create_alternative_choice</code> to generate distance data.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_model_design.html">make_model_design</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/discretefish_subroutine.html">discretefish_subroutine</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>###Likelihood functions FishSET includes six functions. User-created
functions can be saved and logged using the <code>log_func-model</code>
function. <code>logit_c</code> Conditional logit likelihood
<code>logit_avgcat</code> Average catch multinomial logit procedure
<code>logit_correction</code> Full information model with Dahl’s
correction function <code>epm_normal</code> Expected profit model normal
catch function <code>epm_lognormal</code> Expected profit model
lognormal catch function <code>epm_weibull</code> Expected profit model
Weibull catch function</p>
<p>###Model run output The discretefish_subroutine function can take 30
or minutes to run. Model run status is returned to the R console. The
subroutine function outputs model results in a list that can be
summarized as:</p>
<pre><code>errorExplain: If it exists, a description of the model error.
OutLogit: A matrix of coefficients, standard errors, and t-statistics
optoutput: Optimization information (such as number of function iterations)
seoutmat2: Standard errors
MCM: Model comparison metrics (e.g. AIC, BIC)
H1: The inverse hessian</code></pre>
<p>The output can be viewed using:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Display errorExplain output</span></span>
<span><span class="fu"><a href="../reference/globalcheck_view.html">globalcheck_view</a></span><span class="op">(</span><span class="st">'pcodldglobalcheck20190604'</span><span class="op">)</span></span>
<span><span class="co">#Display all other model output.</span></span>
<span><span class="fu"><a href="../reference/model_out_view.html">model_out_view</a></span><span class="op">(</span><span class="st">'pcod'</span><span class="op">)</span></span></code></pre></div>
<p>###Selecting models Model comparison metrics are conveniently saved
in a table in the FishSET database. To access the table use
<code>model_fit</code> with the project name. Identifying the best model
for future reference requires <code>select_model</code>. This function
utilized R Shiny to open an interactive window where best models can be
selected and saved. Model selection can also be accomplished from the
discretefish_subroutine function by setting the
<code>select.model</code> parameter to TRUE. When the parameter is set
to TRUE, a interactive window opens after the model has compiled and
output has saved.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/model_fit.html">model_fit</a></span><span class="op">(</span><span class="st">'pollock'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/select_model.html">select_model</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>##Interactivity R Shiny is used to provide interactive interfaces.
All FishSET functions described here can be run through a user interface
with <code>run_fishset_gui</code>. The user interace guides users
through loading data to model evaluation. In addition, users can use the
<code>select_vars</code> function to open an interactive interface for
selecting a subset of variables to keep in the working data set and the
<code>add_vars</code> function to interactively select vars to add back
into the working data set from the raw dataset.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/run_fishset_gui.html">run_fishset_gui</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/select_vars.html">select_vars</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/select_model.html">select_model</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_vars.html">add_vars</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="reproducibility">Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"></a>
</h2>
<p>FishSET was designed with the aim of reproducibility. All function
calls are logged in a dated file. Log files are stored in the
<code>Logs</code> folder. Each log call has a functionID and a list of
parameters supplies (args). Some logged functions includs kwargs,
optional arguments, an output, or a message. The message section is used
to save text output from a function call that users may want to
reference later, such as the number of number of rows with missing
data.</p>
<p>For example, the function call</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/filter_table.html">filter_table</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="st">'pcodmaindatatable'</span>, project <span class="op">=</span> <span class="st">'pcod'</span>, x <span class="op">=</span> <span class="st">'PERFORMANCE_Code'</span>, exp <span class="op">=</span> <span class="st">'PERFORMANCE_Code==1'</span><span class="op">)</span></span></code></pre></div>
<p>returns the following log entry:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a> {</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>          <span class="st">"functionID"</span><span class="sc">:</span> <span class="st">"filter_table"</span>,</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>          <span class="st">"args"</span><span class="sc">:</span> [</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>            <span class="st">"pcodMainDataTable"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>            <span class="st">"pcod"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>            <span class="st">"PERFORMANCE_Code"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>            <span class="st">"PERFORMANCE_Code==1"</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>          ],</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>          <span class="st">"kwargs"</span><span class="sc">:</span> [],</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>          <span class="st">"output"</span><span class="sc">:</span> <span class="st">""</span>,</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>          <span class="st">"msg"</span><span class="sc">:</span> [</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>            {</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>              <span class="st">"dataframe"</span><span class="sc">:</span> <span class="st">"pcodMainDataTable"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>              <span class="st">"vector"</span><span class="sc">:</span> <span class="st">"PERFORMANCE_Code"</span>,</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>              <span class="st">"FilterFunction"</span><span class="sc">:</span> <span class="st">"PERFORMANCE_Code==1"</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>            }</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>          ]</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>        }</span></code></pre></div>
<p>Log entries are written in JSON. Future version of FishSET will
include a function that will read the log files and rerun function calls
with current or updated data.</p>
<p>Logging is built into FishSET functions. However, it is possible to
start a new log file using <code>log_reset</code>. New log files are
started each day. User-created functions, such as likelihoods, can be
saved for future use and logged using <code>log_func_model</code>.</p>
<p>###Logging</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">`log_reset`</span></span>
<span><span class="va">`log_func_model`</span></span></code></pre></div>
<p>In the FishSET app, each tab has a <code>Notes</code> sections that
is saved to the <code>Output</code> folder. Comments, observations, or
thoughts typed by the user in this section are saved in dated text
files. Additional pre-build messages are also saved, such as output from
data evaluation functions.</p>
<p>Finally, the FishSET package includes a Notebook template for report
writing.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lisa Pfeiffer, Paul G Carvalho, Anna Abelman, Min-Yang Lee, Melanie Harsch, Bryce McManus, Alan Haynie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
